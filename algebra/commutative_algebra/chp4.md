# 整性依赖和零点定理

给定环R和其上的代数S，$p(x) \in R[x]$，如果$s\in S$使得$p(s) = 0$，则称s满足p，如果p还是一个首一多项式，则称s关于R是整的。关于R整的元素对加法和乘法封闭，形成的整扩张的基底具有比较好的性质。

所有S中关于R整的元素构成S的一个子代数，这个子代数被称为R在S内的正规化（normalization），如果R为整环且S为分数域，R关于S的正规化被简称为R的正规化。与自身正规化相同的整环被称为正规环（normal domain）。

## Cayley-Hamilton定理与Nakayama引理

经典的Cayley-Hamilton定理针对的是线性空间上的线性变换，定理本身却可以推广到模上的endomorphism（自同态）：

R为环，M为由n个元素生成的R的模，$I \sub R$为一理想，$\phi$是M上的一个自同态。$\phi(M) \sub IM$，则存在首一多项式$p(x) = x^n + p_{1}x^{n -1} + ... + p_n$，其中$p_i \in I^i$，且$p(\phi) = 0$。

__证明：__需要注意的地方就是要定义比线性代数中矩阵和向量更一般的代数结构。给定环R和R上的模M，向量的各个维可以是M中的元素，而矩阵的表项都是R中的元素，则线性代数中定义的矩阵-向量乘法规则仍然有效。

设$m_1, m_2... m_n$为M的生成元，$\phi(m_i) = \sum a_{ij}m_j, a_{ij}\in I$，定义$A = (a_{ij})$为相应的矩阵。将上面推广定义中的模就取成M而将环取成$R[x]$，$\forall m \in M, xm = \phi(m)$，则有$(x I -A)m_0 = 0$，其中向量$m_0$的各个维为$m_1, m_2...m_n$，两侧同时乘以$(x I - A)$的伴随矩阵，得到
$$
\det(x I - A)I m = 0
$$
从而$\det(xI - A)$即为所求的多项式。每个$p_i$都是若干个由i个A中元素乘积构成的交叉项求和得到的，从而位于$I^i$中

Cayley-Hamilton定理的应用：

+ R和M的假设同上，如果$\alpha : M\to M$是R模得到满同态，则其也是单射：将M看做R[t]上的模，$\forall m \in M, tm = \alpha(m)$，令$I = (t)$，则$IM = M$，对M上的恒等映射用Cayley-Hamilton定理，可以得到：
  $$
  1 - p(t)t = 0
  $$
  从而t的逆映射是$p(t)$

+ 进一步，如果$M \cong R^n$为自由模，则M的任意n个生成元都是其自由基。给定M的n个生成元，可以确定一个满同态$\beta: R^n \to M$，另一方面$M \cong R^n$意味着存在同构$\gamma: M \to R^n$，又根据上面的结论，$\beta\gamma$本身是一个同构。故$\beta$也是同构，从而这些生成元是自由基。这意味着$R^n$的秩是良定义的（$R^n \cong R^m \text{ iff }m=n$，不然其中一个存在等于维数的非自由基生成元）

（$R[x]$商环关于R的有限生成性）设$J \sub R[x]$为理想，$S = R[x] / J$，则S有限生成当且仅当$J$中包含一个首一多项式：J中包含首一多项式则S必然有限生成，反过来，如果S有限生成，则考虑$\phi: s \to xs$，即对每个s中的元乘以x（的像）构成的映射，Cayley-Hamilton定理说明存在一个首一多项式p使得该映射为0，即p(x)位于J中。

在上面的假设下，S是自由R模当且仅当J是由某个首一多项式生成的主理想。如果$S = (p)$，p是次数为n的首一多项式，考虑$1, x, ...x^{n-1}$的像构成的生成元，如果这些生成元是线性相关的，则存在某个次数不大于$n-1$的多项式位于$p$中，矛盾；反过来，如果S是度为n的自由模，则根据上面的有限生成命题，存在某个__度为n-1的__首一多项式$p \in J$，之前自由模的性质又说明它们确实是基底。给定一个$f \in J$，如果f不能被p除尽，则其余数$q \in J$的次数一定低于n（p的__首一__性质），$q\in J$说明某些基底之间的线性组合为0，矛盾，故$f$可被p除尽。

（有限生成代数）给定一个R上的代数S，如果S作为一个R模是有限生成的，则成__S关于R是有限的__。S关于R是有限的当且仅当S作为一个R的代数由有限个关于R整的元素生成：如果S关于R有限，给定$s \in S$，对每个S中的元素乘以s是S的一个自同态，Cayley-Hamilton定理说明s是整的；反过来如果S作为R代数是有限生成的且每个(代数的)生成元都是整的，对(代数的)生成元的个数做归纳，假设在生成元有$t-1$个的时候结论成立，取前t-1个生成元构成S的一个子代数S'，最后一个生成元关于R同样也是关于S‘是整的，从而S是S'[x]除以某个首一多项式生成的主理想得到的，故作为S'模是有限生成的，假设S作为S'模的生成元为$\{t_i\}$，S'作为R模的生成元是$\{s_i\}$，则$\{t_is_j\}$是S作为R模的生成元。

（什么样的元素是整的）设S为R代数，$s \in S$为整元素当且仅当存在一个S模N和有限生成R模$M \sub N$且不被任何S中的元素归零，使得$sM \in M$。如果s为整元素，取N = S而M = R[s]即可；反过来如果存在这样的M和N，则存在关于s的多项式使得$p(s)M = 0$从而p(s) = 0。

上面的结论可以用来证明整元素对加法和乘法具有封闭性：给定关于R整的元素s和s'，设$M = R[s], M' = R[s']$，则M与M'都是R的有限生成模。令MM'为由M和M'中的元素两两乘积得到的结果张成的空间，注意MM'是有限生成的，此外有
$$
(ss')MM' = (sM)(s'M') \sub MM' \\
(s + s')MM' = sMM' + s'MM' \sub MM' + MM' = MM'
$$
（Nakayama引理）R的Jacobson根指所有极大理想的交，令$I$是包含在R的Jacobson理想中的R的理想，M为有限生成R模，如果$IM = M$，则M = 0。

仍然借助Cayley-Hamilton定理，首先证明__如果__$\bold{IM = M}$__则存在__$\bold{r\in I}$__使得(1-r)M =0__。取$\phi$为单位映射，$p(\phi)M = 0$意味着$(1 + p_1+...+p_n)M = 0$，其中$p_i \in I^i$，取$r = -(p_1 + ... + p_n)$即可。但由于$I$位于Jacobson根中，r实际上位于所有极大理想内部，从而1-r位于所有极大理想之外，故1-r为单位元。故M = 0。

一个推论是，如果$m_1, ..., m_n \in M$在$M /IM$中的像是其生成元，则它们同样是M的生成元: 令$N = M / \sum R_im_i$，则
$$
N / IN = M / (IM + \sum R_i m_i) = M /M = 0
$$
第一个等号成立是因为$IN$在M中的原像就是$IM$，从而有$N = IN$故N=0。

如果M，N为有限生成的R模，$M \otimes_R N = 0$，则$\text{ann }M + \text{ann }N = R$：对局部情形证明即可（非局部情形如果不等于R则可对包含两个理想和的极大理想做局部化）从而实际上是证明在R为局部化的情形$\text{ann }M$和$\text{ann} N$中必然有一个是R。假设P为R唯一的极大理想，如果$M \ne 0$，则$M / PM \ne 0$（P就是Jacboson根），但$M/PM$实际上是R/P上的模从而是一个向量空间，这意味着M/PM从而M存在到R/P上的满射，从而$M \otimes N$存在到$R/P \otimes N = N / PN$的满射，这意味着N/PN = 0。从而N = 0。这里用到一个关于张量积的实时就是如果$I$为R的理想，则$R/I \otimes M \cong M / IM$，相应的同构映射将$\bar{r}\otimes m = \bar{1}\otimes rm$映射到$rm + IM$。


## 正规环与正规化过程

回忆正规环(domain)是在其分数域中的整闭包等于自身的环。如果环本身允许唯一分解（Unique Factorization Domain），则环本身就是正规的。通过证明整既约分数分子分母存在公因子即可。

给定$R \sub S$为两个环，f为R[x]中的首一多项式，如果f在S[x]中可以分解为f = gh，且g和h都是首一多项式，则g与h的系数关于R都是整的。证明通过对S进行（关于R的）整扩张使得g和h能够分裂，g与h的根事实上关于R都是整的，而它们的系数都是关于这些根的对称函数，从而也是整的。

（高斯引理推广）如果R为正规环，则$R[x]$中任意不可约首一多项式都是$R[x]$中的素多项式。令$f\in R[x]$为$R[x]$中不可约首一多项式，Q为R的分数域，根据上面的结论，__f同样是Q[x]中的不可约元素__，而Q[x]本身是UFD，从而f是Q[x]中的素元素，$(f)$为$Q[x]$中素理想。另一方面f是首一多项式意味着$R[x]/(f)$是关于R的自由模，从而其到关于R本身的局部化模中的映射是单射，即
$$
R[x]/(f) \to Q\otimes (R[x]/(f)) = (Q\otimes R[x]) / (Q\otimes (f)) = Q[x]/(fQ[x])
$$
是单射，注意到最右边是domain，从而最左边也是，故$(f)$是素理想，f是素元素。

取整闭包操作与局部化可交换。$R \sub S$为环，$S'$为R在S中的整闭包，U为R中的乘法封闭集，则$S'[U^{-1}]$是$S[U^{-1}]$中$R[U^{-1}]$的整闭包。

域扩张下的整闭包(来自Algebraic Number Theory)：A为一个具有整闭性的domain，K为其分数域，L|K是有限域扩张，B是A在L中的整闭包。则B本身是normal的（B的normalization是关于A整的）。L中的任意一个元素事实上都可以写成$\frac \beta a$的形式，其中$\beta \in B, a \in A$。且L中的元素位于A中当且仅当其极小多项式（$K[x]$所有化零多项式中次数最低的首一多项式）的系数都在A中。

## 整扩张中的素理想

(laying over and going up)$R \sub S$为环的整扩张，给定R的素理想P，存在一个S的素理想Q使得$R \cap Q = P$，事实上可以选择Q使得Q包含任意的满足$Q_1 \cap R \sub P$的S的素理想$Q_1$。对$Q_1$做商可以转回到$Q$的存在性。由于整扩张和局部化可交换，可以对扩张做关于$R - P$的局部化，从而假设R是具有唯一极大理想P的局部环。事实上包含PS的S中的极大理想的原像必然包含P，从而等于P（局部性质）。这里只要证明$PS \ne S$即可。如果$PS = S$，则1可以表示成S中的若干元素关于P中元素的线性组合，这些S中的元素生成的子代数S'满足PS' = S'，注意到S'的元素都是关于R整的且是有限生成代数，则S'是有限生成R模，根据Nakayama引理，S' = 0。矛盾。

引理：令$R \sub S$为domain，$K(S)$为关于$K(R)$的代数扩张，则S的任意理想都和R交于某个非零元。（证明代数元的主理想中有R中的元素）。

$R \sub S$为domain的扩张，则S是域当且仅当R是域。如果R是域，则上面的引理说明S的任意一个理想中存在单位元，从而S是域；反过来，给定R的一个极大理想m，存在S的一个素理想与R的交为m。但S唯一的素理想就是0，从而R只有0一个极大理想。等价地，S的理想P是极大理想当且仅当$P \cap R$是R的极大理想。

上面的结论的推论是任意两个S中的素理想$P_1$和$P_2$如果与R的交相同，则$P_1$和$P_2$中彼此包含对方没有的某个元素。如果$P_1 \sub P_2$，则$S/P_1$是一个域，其中$P_2$的像和$R$的交是0。由于此时$S/P_1$仍然是$R / (R\cap P_1)$的整扩张且两者都是domain，引理说明$P_2 $的像为0。



## Nullstellensatz

一个环被称为具有Jacobson性质，如果其所有素理想都是某些极大理想的交。推广的零点定理说明Jacobson环的有限生成代数仍然是Jacobson环：

令R为Jacobson环，S为有限生成R代数，则S也是Jacobson环，给定任意S的极大理想$\mathfrak{m}$，$\mathfrak{n} = \mathfrak{m} \cap R$也是R的极大理想，且$S / \mathfrak{m}$是$R / \mathfrak{n}$的有限扩张。

(Jacobson等价性)环R是Jacobson的当且仅当：给定素理想$P \sub R$，如果$S =R / P$中存在一个$b \ne 0$使得$S[b^{-1}]$为一个域，则S是域。

+ 必要性：R是Jacobson的意味着S = R/P也是Jacobson的，且S是一个Domain意味着S的素理想的交（从而是极大理想的交）是$\{0\}$，$S[b^{-1}]$中的素理想是S中所有不包含b的那些理想的像，不存在这样的非零素理想（$S[b^{-1}]$是域）意味着$b$落在所有的S的非零素理想中都包含b。但是这与上面得到的它们的交是$\{0\}$矛盾，从而S没有非零素理想。
+ 充分性：给定$Q \sub R$为素理想，令$I$为所有R中包含Q的极大理想的交，证明$I = Q$即可。如果存在$f\in I - Q$，令P是R中包含Q且不包含f的极大素理想，则P不是极大理想，R/P不是域；但P又生成一个$R[f^{-1}]$中的极大理想。从而$R[f^{-1}]/P = (R/P)[f^{-1}]$是域，R/P应该也是域，矛盾。

零点定理的证明：

+ 对于R为域，$S = R[x]$的情形。此时S的任意一个非零素理想都是由某个不可约多项式生成的主理想，从而是极大理想（如果还有更大的，则相应的不可约多项式存在因子）。为了证明0是极大理想的交，只要证明存在无限多个素理想（即素元素）即可。

+ 对于R为一般的Jacobson环，S是由一个元素t生成的R代数。利用上面的判定性质，给定素理想$P \sub S$和$b \in S/P, b \ne 0$使得$S[b^{-1}]$为域，证明$S /P$也是域。对R关于P同样做商，可以假定R包含在domain S之内，$b \in S, b \ne 0, S[b^{-1}]$为域，接下来证明S是域，R是域且S是R的有限代数扩张。这个结论可以方便地证明原来定理中关于极大理想的论述：对S和R关于$\mathfrak{m}$做商即可。$R / \mathfrak m \cap R$是域等价于$\mathfrak{m} \cap R$为R的极大理想。b取1即可证明$S / \mathfrak{m}$是$R / \mathfrak{n}$的有限扩张。

  在上面的假设下，令$S = R[x]/ Q$，Q为素理想（已经假设了S为domain）。首先说明Q不等于0。不然$R[x][b^{-1}]$为域意味着$k[x][b^{-1}]$是域，k是R的分数域。$k[x]$的Jacobson性质意味着k[x]也是一个域，矛盾。从而存在$p \in Q, p \ne 0$。

  令
  $$
  p(t) = p_n t^n + p_{n-1}t^{n-1} + ... + p_0 = 0
  $$
  则t关于$R[p_n^{-1}]$整，b同样满足某个代数式
  $$
  q(b) = q_mb^m + ... + q_0 = 0
  $$
  由于S为domain可以额外假设$q_0 \ne 0$，上式两侧同事除以$b^m$，得到$\beta = b^{-1}$关于$R[q_0^{-1}]$整。有了$t$和$\beta$两个生成元，得到$S[\beta]$关于$R[p_n^{-1}q_0^{-1}]$整。$S[\beta]$是域意味着$R[(p_nq_0)^{-1}]$是域。从而R是域，故S本身关于R是一个整扩张，进一步，S是域。

+ S为有限生成R代数的情形可以通过对生成元的个数做归纳得到。

经典Nullstellensatz定理的证明：

+ $S =k[x_1, ... x_n]$中的极大理想都是由形如$x_1 - p_1, ...x_n - p_n$的单项式生成的。这样的单项式生成的理想是极大理想，可以通过考察商环得到；反过来，给定一个S中的极大理想$\mathfrak{m}$，$\mathfrak{m} \cap k$是k的极大理想0，$S / \mathfrak{m}$是$k / k \cap \mathfrak{m} = k$的有限代数扩张。k的代数封闭性意味着$S / \mathfrak{m} = k$，令$p_1, p_2...p_n$为$x_1, x_2, ... x_n$在商映射下的像，则
  $$
  \mathfrak{m} \supset (x_1 - p_1, ..., x_n - p_n)
  $$
  但是右侧是极大理想，从而两者相等。

+ 一般地给定理想$I$，$Z(I)$中的点对应的理想就是包含$I$的极大理想，从而$I(Z(I))$是所有包含$I$的极大理想的交。根据S的Jacobson性质，这相当于所有包含$I$的素理想的交，即$\text{rad}(I)$



## 习题

（有限生成的多项式环上的模）令R为一个包含了域k上单变量多项式环S = k[x]的一个domain，如果R作为一个S模是有限生成的，则R是一个自由S模：对R关于S做局部化，$R[S^{-1}]$是关于$K(S)$的向量空间。由于R关于S是有限的，该向量空间也是有限维的。从向量空间中选取基底$b_1, ..., b_n$。对每个$b_i$，考察$M_i = b_iK(S) \cap R$是R的一个子模，接下来证明这个子模可以由单个元素生成。又整个R实际上可以看做这些子模的直和，故R是自由模。

给定$r_1, r_2 \in M_i$，则存在互素的$f, g\in S$使得$r_1 = r_2 \frac f g$。注意到$r_1,r_2$关于S是整的，设：
$$
h_1(r_1) = r_1^n + a_{n-1}r_1^{n-1} + ... + a_0 = 0 \\
h_2(r_2) = r_2^m + b_{m-1}r_2^{m - 1} + ... + b_0 = 0
$$
分别是$r_1, r_2$的化零多项式中次数最小的首一多项式。$\{a_i\}, \{b_i\}$都是S中的元素。由S的正规性质可知这两个多项式是$K(S)$中的不可约多项式（如果可约则存在次数更低者）。如果$n < m$，带入$r_1 = r_2 \frac f g$到第一个方程中可以得到一个关于$r_2$的次数更低的化零多项式，这意味着$h_2$在$K(S)[x]$中存在次数更低的首一因子。S的normal性质说明这些因子都在S[x]中，矛盾（上面的论述实际上证明了对于normal domain R和关于R整的元素a，a的次数最低的R[x]中的化零多项式是首一多项式）。故
$$
\text{deg}(h_1) = \text{deg}(h_2)
$$
即$m = n$。将$r_1 = \frac f g r_2$带入$h_1$得到：
$$
(\frac{f}{g})^n r_2^n + (\frac{f}{g})^{n-1} a_{n - 1}r_2^{n - 1} + (\frac{f}{g})^{n - 2} a_{n - 2}r_2^{n - 2} + ... + a_0 = 0 \\
\Leftrightarrow h'_2(r_2) = f^nr_2^n + f^{n - 1}g^{}a_{n-1}r_2^{n - 1} + f^{n - 2}g^{2}a_{n-2}r_2^{n - 2} + ... + a_0g^n = 0
$$
对比
$$
h_2(r_2) = r_2^n + b_{n - 1}r_2^{n - 1} + ... + b_0 = 0
$$
是次数最低的$r_2$的化零多项式，可以得到$h'_2 = f^n h_2$（不然有次数更低的化零多项式）。从而
$$
a_{n-1} g = b_{n-1}f \\
a_{n-2} g^2 = b_{n-2}f^2 \\
... \\
a_0g^n = b_0f^n
$$
g和f互素说明$a_{n-1}$中有f因子，$a_{n-2}$中有$f^2$因子...这意味着多项式
$$
x^n +  \frac{a_{n-1}}{f}x^{n-1} + ... + \frac{a_0}{f^n} = 0
$$
的系数都在S内。这说明$\frac{r_1}{f}$关于S整。$f$和$g$互素和S是主理想环说明存在$d_1, d_2 \in S, d_1f + d_2g = 1$，从而$d_1r_1 + d_2r_2 = \frac{r_1}{f}$位于R中。即$\exist r, Sr_1 + Sr_2 = Sr$。该结论结合S作为R的Noetherian模可以得到$M_i$的任何一个一维子模链存在极大元。根据Zorn引理，$M_i$的一维子模存在极大元。这个元素事实上就等于$M_i$，不然有更大的元素。

（不借助行列式的Nakayama引理的证明）R的Jacobson理想J事实上可以写成：$J = \{r \in R | \forall s \in R, 1+rs \text{ is a unit} \}$，对于任意满足条件的元素都在Jacobson理想中的证明，考虑给定$r \notin J$，则存在某个极大理想$I$使得$r \notin I$，由于$R / I$为域，故存在$s \in R$使得$rs + 1 \in I$，从而不是单位元。

如果对有限生成模M，有JM = M，考虑对M的生成元数目做归纳以证明M = 0。借助于上面的Jacobson理想判定，M的任意一个生成元乘以某个R中的单位元都可以用其他生成元表示出来，从而M事实上可以由一个元素a生成。M = JM意味着$\exists r\in J, s\in R , rsa = a$，从而$(1-rs)a = 0$，故a = 0。